\documentclass{article}

% URLs and hyperlinks ---------------------------------------
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=blue,
}
\usepackage{xurl}
%----------------------------------------------------

\usepackage{paralist}
\usepackage{amsmath, amssymb, empheq}
\usepackage{enumitem}
\usepackage{adjustbox}
\usepackage{euler}
\usepackage{graphicx}
\usepackage{float}

\usepackage{xepersian}
\settextfont{Yas}
\newcommand{\modts}{\overset{26}{\equiv}}

\title{تکلیف دوم}
\author{مهدی حق‌وردی}
\date{\today}

\begin{document}
\maketitle

\section{}
\textbf{{\large با توجه به سیستم رمزنگاری \lr{DES} به سوالات زیر پاسخ دهید.}}

\begin{enumerate}[label=\alph*)]
\item 
\textbf{تعداد کل عملیات‌های 
\lr{\texttt{xor}}
را بدست آورید.}

از آنجایی که 
\lr{DES}
یک ساختار فیستلی ۱۶ دوری است، در بیرون از تابع 
\lr{F},
۱۶ تا 
\lr{\texttt{xor}} 
قرار دارد. و چون درون تابع
\lr{F}
پس از عملیات 
\lr{extend}
یک بار با کلید 
\lr{\texttt{xor}}
انجام می‌گیرد پس اینجا هم ۱۶ تا عملیات 
\lr{\texttt{xor}}
داریم و در مجموع ۳۲ عملیات 
\lr{\texttt{xor}}.

\item 
\textbf{هدف از 
\lr{s-box}ها
را بنویسید.}

نوشتن رابطه‌ی جبری برای بیت‌‌های خروجی بر حسب بیت‌های ورودی و کلید \textbf{به دلیل وجود \lr{s-box}} بسیار دشوار است.

\item 
\textbf{پیچیدگی حمله‌ی جست‌وجوی جامع به این سیستم از چه مرتبه‌ای می‌باشد؟}

کلید 
\lr{DES},
۶۴ بیتی است که ۸ بیت آن بیت‌های 
\lr{parity}
هستند پس کلید مخفی آن تنها ۵۶ بیت طول دارد $\leftarrow$ جستجوی کامل در 
\lr{DES} 
از مرتبه‌ی 
$2^{56}$
است.

\item 
\textbf{دلیل استفاده از 
\lr{expansion s-box}
در 
\lr{DES Function}
چیست؟}

کلید ۵۶ بیتی 
\lr{DES}
توسط 
\lr{Key Scheduler}
به ۱۶ کلید ۴۸ بیتی تبدیل می‌شود و از آنجایی که طول بلاک 
\lr{DES}
۶۴ بیت است و در ساختار فیستل تنها ۳۲ بیت آن به داخل تابع 
\lr{F}
می‌رود باید ۳۲ بیت ورودی را به ۴۸ بیت گسترش بدهیم تا بتوانیم آن را با کلید 
\lr{\texttt{xor}}
کنیم.

\item 
\textbf{اگر خروجی سیستم رمزنگاری به یک سیستم رمزنگاری دیگر داده شود، چه تغییری در
امنیت آن حاصل می‌شود؟ \lr{(double des)} اگر این کار سه بار تکرار شود
چطور؟ 
\lr{(triple des)}}

\begin{itemize}
\item \lr{double des}

در این حالت برای شکستن می‌توان از حمله‌ی تطابق در میانه استفاده کرد که مرتبه‌ی آن از 
$2^{112}$
به
$2^{57}$ 
تقلیل می‌یابد.

\item \lr{triple des}

در این حالت هم (با استفاده از حمله‌ی تطابق در میانه) مرتبه بجای 
$2^{168}$
می‌شود:
$2^{112}$ که البته در عمل قابل انجام نیست. در سال ۲۰۱۷ 
\lr{NIST}
منسوخ شدن
\lr{3DES}
را اعلام کرد.

\end{itemize}
\item 
ویژگی مکمل بودن این سیستم را ثابت کنید و توضیح دهید در آن صورت حمله به
این سیستم از چه مرتبه‌ایست و چرا؟

خاصیت مکمل بودن 
\lr{DES}:
\begin{latin}
\begin{equation}
\text{DES}_\text{K}(\text{M}) = \text{C}
\Rightarrow
\text{DES}_{\overline{\text{K}}}(\overline{\text{M}}) = \overline{\text{C}}
\end{equation}
\end{latin}

(برای اثبات فقط یک دور را در نظر میگیریم) با توجه به ساختار فیستلی 
\lr{DES}
ورودی ابتدا به دو قسمت تقسیم میکند و سپس نیمه‌ی راست را (درون تابع \lr{F}) با کلید 
\lr{\texttt{xor}}
می‌کند و سپس خروجی را با قسمت سمت چپ 
\lr{\texttt{xor}}
می‌کند.
\begin{center}
\includegraphics[width=0.4\textwidth, height=0.35\textheight]{des-feistel}
\end{center}
که یعنی:
\begin{equation}
\begin{cases}
P = L_0.R_0\\
L_1 = R_0 \\
B = f(R_0 \oplus K_1) \\
R_1 = L_0 \oplus B
\end{cases}
\Rightarrow C = L_1.R_1
\end{equation}

حال اگر 
\lr{$P$}
و 
\lr{$K$}
را 
\lr{\texttt{not}}
کنیم:
\begin{equation}
\begin{cases}
\overline{P} = \overline{L_0.R_0}\\
L_1 = \overline{R_0} \\
B = f(\overline{R_0} \oplus \overline{K_1}) \\
R_1 = \overline{L_0} \oplus B
\end{cases}
\Rightarrow \overline{C} = \overline{L_1.R_1}
\end{equation}

پس در نتیجه:
\begin{equation}
E_k(P) = C \iff E_{\overline{k}}(\overline{P}) = \overline{C}
\end{equation}
\end{enumerate}

\section{}
{\large \textbf{با استفاده از یک کلید رمز واحد، هر یک ازتبدیلات زیر را بر متن آشکار که تنها در بیت اول با هم تفاوت دارند، اعمال کنید. تعداد بیت‌های تغییر یافته پس از هرتبدیل را پیدا کنید. هرتبدیل را بطور مستقل اعمال کنید. در مورد اثر بهمنی پس از هرتبدیل بطور مستقل و سپس اثر بهمنی پس از اعمال یک راند توضیح دهید.}}

\begin{enumerate}[label=\alph*)]
\item \lr{subBytes}
\item \lr{shiftRows}
\item \lr{mixColumns}
\item \lr{addRoundKey}
\end{enumerate}

\section{}
{\large \textbf{از بین مدهای عملیاتی
\lr{ECB},
\lr{CBC},
\lr{OFB},
\lr{CFB}
و
\lr{CTR}
در کدام یک امکان افزایش سرعت در عمل رمزگذاری با استفاده از
\lr{parallel processing}
یا پردازش موازی وجود دارد؟}}
\end{document}